//
//
//
//
//package com.exploit.fastjson;
//
//import java.io.FileInputStream;
//import java.nio.file.FileVisitOption;
//import java.nio.file.Files;
//import java.nio.file.Path;
//import java.nio.file.Paths;
//import java.util.*;
//import java.util.Map.Entry;
//import java.util.jar.JarEntry;
//import java.util.jar.JarInputStream;
//import java.util.stream.Stream;
//
//import com.alibaba.fastjson.util.TypeUtils;
//
//public class WhiteList {
//
//    /*
//     * 每次升级后更新此处的私有哈希值
//     *
//     * from 1.2.70
//     *
//     * com.alibaba.fastjson.parser.ParserConfig
//     */
//    private static long[] whiteHashCodes = new long[]
//            {
//                    0x82E8E13016B73F9EL,
//                    0x863D2DD1E82B9ED9L,
//                    0x8B2081CB3A50BD44L,
//                    0x90003416F28ACD89L,
//                    0x92F252C398C02946L,
//                    0x9E404E583F254FD4L,
//                    0x9F2E20FB6049A371L,
//                    0xA8AAA929446FFCE4L,
//                    0xAB9B8D073948CA9DL,
//                    0xAFCB539973CEA3F7L,
//                    0xB5114C70135C4538L,
//                    0xC0FE32B8DC897DE9L,
//                    0xC59AA84D9A94C640L,
//                    0xC92D8F9129AF339BL,
//                    0xCC720543DC5E7090L,
//                    0xD0E71A6E155603C1L,
//                    0xD11D2A941337A7BCL,
//                    0xDB7BFFC197369352L,
//                    0xDC9583F0087CC2C7L,
//                    0xDDAAA11FECA77B5EL,
//                    0xE08EE874A26F5EAFL,
//                    0xE794F5F7DCD3AC85L,
//                    0xEB7D4786C473368DL,
//                    0xF4AA683928027CDAL,
//                    0xF8C7EF9B13231FB6L,
//                    0xD45D6F8C9017FAL,
//                    0x6B949CE6C2FE009L,
//                    0x76566C052E83815L,
//                    0x9DF9341F0C76702L,
//                    0xB81BA299273D4E6L,
//                    0xD4788669A13AE74L,
//                    0x111D12921C5466DAL,
//                    0x178B0E2DC3AE9FE5L,
//                    0x19DCAF4ADC37D6D4L,
//                    0x1F10A70EE4065963L,
//                    0x21082DFBF63FBCC1L,
//                    0x24AE2D07FB5D7497L,
//                    0x26C5D923AF21E2E1L,
//                    0x34CC8E52316FA0CBL,
//                    0x3F64BC3933A6A2DFL,
//                    0x42646E60EC7E5189L,
//                    0x44D57A1B1EF53451L,
//                    0x4A39C6C7ACB6AA18L,
//                    0x4BB3C59964A2FC50L,
//                    0x4F0C3688E8A18F9FL,
//                    0x5449EC9B0280B9EFL,
//                    0x54DC66A59269BAE1L,
//                    0x552D9FB02FFC9DEFL,
//                    0x557F642131553498L,
//                    0x604D6657082C1EE9L,
//                    0x61D10AF54471E5DEL,
//                    0x64DC636F343516DCL,
//                    0x73A0BE903F2BCBF4L,
//                    0x73FBA1E41C4C3553L,
//                    0x7B606F16A261E1E6L,
//                    0x7F36112F218143B6L,
//                    0x7FE2B8E675DA0CEFL
//            };
//
//
//
//    /*
//     * from 1.2.42
//     *
//     * com.alibaba.fastjson.parser.ParserConfig.checkAutoType(String, Class, int)
//     */
//    private static void PrivateFindBlackname(String typeName, HashMap<Long, String> hm) {
//        String className = typeName.replace('$', '.');
//        long fullHash = TypeUtils.fnv1a_64(className);
//        if (Arrays.binarySearch(whiteHashCodes,fullHash)>0) hm.put(fullHash, className);
//    }  /* end of PrivateFindBlackname */
//
//    private static void EnumerateClassFromJar(String JarFile) {
//        try {
//
//            JarInputStream jis = new JarInputStream(new FileInputStream(JarFile), false);
//            JarEntry je;
//            String EntryName;
//            String ClassName;
//            /*
//             * 此处Long不能写成long，Integer不能写成int
//             */
//            HashMap<Long, String> hm = new HashMap<>();
//
//            while (true) {
//                je = jis.getNextJarEntry();
//                if (je == null) {
//                    break;
//                }
//                EntryName = je.getName();
//                if (EntryName.endsWith(".class")) {
//                    // System.out.println( EntryName );
//                    /*
//                     * 干掉结尾的".class"再替换
//                     */
//                    ClassName = EntryName.substring(0, EntryName.length() - 6).replace("/", ".");
//                    // System.out.println( ClassName );
//                    PrivateFindBlackname(ClassName, hm);
//                }
//            }
//
//            Set<Entry<Long, String>> es = hm.entrySet();
//            Iterator<Entry<Long, String>> it = es.iterator();
//            Map.Entry<Long, String> e;
//            long hash;
//            String sth;
//
//            while (it.hasNext()) {
//                e = it.next();
//                hash = e.getKey();
//                sth = e.getValue();
////                System.out.println(String.format("%d %#x %s", hash, hash, sth));
//                System.out.println( sth);
//
//            }
//        } catch (Exception e) {
//            System.out.println(e.toString());
//            e.printStackTrace();
//        }
//    }  /* end of EnumerateClassFromJar */
//
//    private static void EnumerateFileFromDir(String dir, String suffix) {
//        /*
//         * Java 8的用法，Java 7不支持
//         *
//         * https://docs.oracle.com/javase/8/docs/api/java/nio/file/Files.html
//         * https://docs.oracle.com/javase/8/docs/api/java/nio/file/Paths.html
//         */
//        try
//                (Stream<Path> paths = Files.walk(Paths.get(dir), FileVisitOption.FOLLOW_LINKS)) { paths
//                .filter(Files::isRegularFile)
//                .map(p -> p.toString())
//                .filter(name -> name.endsWith(suffix))
////                    .peek( System.out::println )
//                .forEach(WhiteList::EnumerateClassFromJar);
//        } catch (Exception e) {
//            System.out.println(e.toString());
//            e.printStackTrace();
//        }
//    }  /* end of EnumerateFileFromDir */
//
//    public static void main(String[] argv) throws Exception {
//
//        String dir = argv[0];
//        EnumerateFileFromDir(dir, ".jar");
//    }
//
//}
//
